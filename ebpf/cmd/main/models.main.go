/**
*	Type: package
*	Name: main
*	Description: This file defines the data types
*			     used by this package.
*
*	Authors: Charan Ravela
*	Created On: 04-27-2023
*
*	Last Modified By: Charan Ravela
*	Last Modified: 04-27-2023
 */
package main

import "tarian/pkg/ebpf"

/**
*	Type: DataType
*	Name: programContext
*	Description: This structure defines the context
*			     of the program.
*
*
*	Authors: Charan Ravela
*	Created On: 04-17-2023
*
*	Last Modified By: Charan Ravela
*	Last Modified: 04-27-2023
 */
type programContext struct {
	stats     programStats
	currStats programStats

	config programConfig

	channels programChannels

	should_stop  bool
	ebpfPrograms []*ebpf.EbpfHandlers

	cache []ebpf.Event
}

/**
*	Type: DataType
*	Name: programStats
*	Description: This structure stores the statistics related
*				 to the data generated by the program.
*
*
*	Authors: Charan Ravela
*	Created On: 04-27-2023
*
*	Last Modified By: Charan Ravela
*	Last Modified: 04-27-2023
 */
type programStats struct {
	totalFilesCount    int     //total count of the files generated
	totalExportSize    float64 //total size of exported data
	totalCapturedCount int     //total count of records captured
}

/**
*	Type: DataType
*	Name: programChannels
*	Description: This structure contains the channels used for communication.
*
*
*	Authors: Charan Ravela
*	Created On: 04-27-2023
*
*	Last Modified By: Charan Ravela
*	Last Modified: 04-27-2023
 */
type programChannels struct {
	exportChan chan interface{}
	common     ebpf.Communication
}

/**
*	Type: DataType
*	Name: programChannels
*	Description: This structure holds the configuration data used by the program.
*
*
*	Authors: Charan Ravela
*	Created On: 04-27-2023
*
*	Last Modified By: Charan Ravela
*	Last Modified: 04-27-2023
 */
type programConfig struct {
	showProgress  bool
	printToScreen bool
	exportAs      []exportOptions
}

/**
*	Type: DataType
*	Name: exportOptions
*	Description: This structure holds export options into different formats.
*
*
*	Authors: Charan Ravela
*	Created On: 04-27-2023
*
*	Last Modified By: Charan Ravela
*	Last Modified: 04-27-2023
 */
type exportOptions struct {
	enabled       bool
	format        string
	directory     string
	exportOptions []exportTrigger
}

/**
*	Type: DataType
*	Name: exportTrigger
*	Description: This structure defines the type of trigger.
*
*
*	Authors: Charan Ravela
*	Created On: 04-27-2023
*
*	Last Modified By: Charan Ravela
*	Last Modified: 04-27-2023
 */
type exportTrigger struct {
	kind    string
	enabled bool
	value   int
}
